{
    "id": "{{service.name}}",
    "cpus": {{grafana.cpus}},
    "mem": {{grafana.mem}},
    "instances": 1,
    "env": {
        "GF_SERVER_DOMAIN": "{{grafana.server.domain}}",
        "GF_SERVER_ROOT_URL": "{{grafana.server.root_url}}",
        "GF_INSTALL_PLUGINS": "{{grafana.plugins}}",
        "GF_SECURITY_ADMIN_PASSWORD": "{{grafana.admin_password}}",
        "GF_USERS_AUTO_ASSIGN_ORG_ROLE": "{{grafana.auto_assign_org_role}}",
        "GF_AUTH_BASIC_ENABLED": "{{grafana.auth_basic_enabled}}",
        "GF_AUTH_GITHUB_ENABLED": "{{grafana.auth_github.enabled}}",
        "GF_AUTH_GITHUB_AUTH_URL": "{{grafana.auth_github.auth_url}}",
        "GF_AUTH_GITHUB_API_URL": "{{grafana.auth_github.api_url}}",
        "GF_AUTH_GITHUB_TOKEN_URL": "{{grafana.auth_github.token_url}}",
        "GF_AUTH_GITHUB_CLIENT_ID": "{{grafana.auth_github.client_id}}",
        "GF_AUTH_GITHUB_CLIENT_SECRET": "{{grafana.auth_github.client_secret}}",
        "GF_AUTH_GITHUB_SCOPES": "{{grafana.auth_github.scopes}}"
    },
    "container": {
        "type": "DOCKER",
        "docker": {
            "image": "{{resource.assets.container.docker.grafana-docker}}",
            "forcePullImage": false,
            "network": "BRIDGE",
            "portMappings": [
            {
                "containerPort": 3000,
                "hostPort": 0,
                {{#networking.external_access.enable}}
                "servicePort": {{networking.external_access.external_access_port}},
                {{/networking.external_access.enable}}
                "protocol": "tcp"
            }
            ]
        }
    },
    "healthChecks": [
        {
            "protocol": "MESOS_HTTP",
            "path": "/api/health",
            "portIndex": 0,
            "gracePeriodSeconds": 300,
            "intervalSeconds": 60,
            "timeoutSeconds": 20,
            "maxConsecutiveFailures": 3
        }
    ],
    "labels": {
        "DCOS_PACKAGE_VERSION": "{{package.version}}",
        "DCOS_SERVICE_NAME": "{{service.name}}",
        "DCOS_SERVICE_PORT_INDEX": "0",
        "DCOS_SERVICE_SCHEME": "http",
        {{#networking.external_access.enable}}
        "HAPROXY_GROUP": "external",
        "HAPROXY_0_VHOST": "{{networking.external_access.virtual_host}}",
        {{/networking.external_access.enable}}
        "DCOS_PACKAGE_IS_FRAMEWORK": "false"
    }
}
